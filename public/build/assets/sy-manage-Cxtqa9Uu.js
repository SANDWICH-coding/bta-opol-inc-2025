import{r as t,j as e,L as ie,S as u}from"./app-Cl5YLaWy.js";import{A as ne,L as o}from"./app-layout-ucZ1afEX.js";import{C as re,a as ce,b as oe,c as de}from"./card-Cumxlg5F.js";import{B as i}from"./button-BJ4pABBN.js";import{T as me,t as r}from"./index-BQTUomXl.js";import{D as y,a as N,b,c as f,d as v,e as C}from"./dialog-DN7VLVWh.js";import{I as d}from"./input-BLdyOvoV.js";import{S as O,a as G,b as H,c as P,d as L,e as ue}from"./select-CGAdxEsb.js";import{L as R}from"./loader-circle-CE4NOa1q.js";import"./index-y5EgsyF4.js";import"./utils-jAU0Cazi.js";import"./index-qKjcTZ5C.js";import"./index-BGUDf74b.js";import"./createLucideIcon-CeGMdPTk.js";import"./tooltip-C6F99bXP.js";import"./index-BjFNjnDZ.js";import"./floating-ui.react-dom-kMN8wKD0.js";import"./avatar-TwsMtWiI.js";import"./app-logo-icon-BxBGbhax.js";import"./index-BdQq_4o_.js";import"./chevron-down-C8oPuirk.js";import"./chevron-up-CAPICZ_W.js";function Ee({schoolYear:n,billingCategories:$}){const[S,F]=t.useState({}),[z,A]=t.useState(!1),[k,D]=t.useState(!1),[B,M]=t.useState({school_year_id:n.id,yearLevelName:""}),J=()=>{M({school_year_id:n.id,yearLevelName:""}),A(!0)},K=s=>{s.preventDefault(),D(!0),u.post("/admin/year-level",B,{onSuccess:()=>{D(!1),A(!1),r.success("Year level created successfully"),u.reload()},onError:a=>{D(!1),r.error(a.yearLevelName||"Failed to create year level")}})},Q=s=>{const{name:a,value:l}=s.target;M(c=>({...c,[a]:l}))},[U,h]=t.useState(!1),[I,_]=t.useState(!1),[E,q]=t.useState({year_level_id:0,classArmName:""}),W=s=>{q({year_level_id:s,classArmName:""}),h(!0)},X=s=>{s.preventDefault(),_(!0),u.post("/admin/class-arm",E,{onSuccess:()=>{_(!1),h(!1),F({}),r.success("Class arm created successfully"),u.reload()},onError:a=>{_(!1),a&&typeof a=="object"?F(a):r.error("Failed to create class arm")}})},Y=s=>{const{name:a,value:l}=s.target;q(c=>({...c,[a]:l}))},[Z,x]=t.useState(!1),[p,T]=t.useState({year_level_id:0,category:"",description:"",amount:0}),ee=s=>{T({year_level_id:s,category:"",description:"",amount:0}),x(!0)},se=s=>{s.preventDefault(),u.post("/admin/billing",p,{preserveScroll:!0,onSuccess:()=>{x(!1),r.success("Billing created successfully")},onError:a=>{r.error(a.category||"Failed to create billing")}})},w=s=>{const{name:a,value:l}=s.target;T(c=>({...c,[a]:l}))},[ae,g]=t.useState(!1),[m,j]=t.useState({school_year_id:n.id,billing_cat_id:0,description:"",value:"",amount:0}),le=()=>{j({school_year_id:n.id,billing_cat_id:0,description:"",value:"",amount:0}),g(!0)},te=s=>{s.preventDefault(),u.post("/admin/billing-discount",m,{preserveScroll:!0,onSuccess:()=>{g(!1),r.success("Discount created successfully")},onError:a=>{r.error(a.description||"Failed to create discount")}})},V=s=>{const{name:a,value:l}=s.target;j(c=>({...c,[a]:a==="billing_cat_id"?parseInt(l):l}))};return e.jsxs(ne,{breadcrumbs:[{title:"School Year",href:"/admin/school-year"},{title:"Manage School Year",href:"#"}],children:[e.jsx(ie,{title:`${n.name}`}),e.jsx(me,{richColors:!0,position:"top-center"}),e.jsxs("div",{className:"p-4 space-y-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:n.name}),e.jsx(i,{onClick:J,children:"Create Year Level"}),n.year_levels.length===0&&e.jsx("p",{className:"text-gray-500",children:"No year levels found for this school year."}),n.year_levels.map(s=>e.jsxs(re,{children:[e.jsx(ce,{children:e.jsx(oe,{children:s.yearLevelName})}),e.jsxs(de,{children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-sm font-semibold mb-2",children:"Class Arms"}),s.class_arms.length===0?e.jsx("p",{className:"text-sm text-gray-500",children:"No class arms added."}):e.jsx("ul",{className:"list-disc pl-5 space-y-1",children:s.class_arms.map(a=>e.jsx("li",{className:"text-sm text-gray-700",children:a.classArmName},a.id))}),e.jsx(i,{variant:"outline",className:"mt-4",onClick:()=>W(s.id),children:"Add Class"})]}),e.jsxs("div",{className:"mt-8",children:[e.jsx("h2",{className:"text-sm font-semibold mb-2",children:"Billing Items"}),s.billings.length===0?e.jsx("p",{className:"text-sm text-gray-500",children:"No billings added."}):e.jsx("ul",{className:"list-disc pl-5 space-y-1",children:s.billings.map(a=>{var l;return e.jsxs("li",{className:"text-sm text-gray-700",children:[(l=a.category)==null?void 0:l.name,": ₱",a.amount]},a.id)})}),e.jsx(i,{variant:"outline",className:"mt-4",onClick:()=>ee(s.id),children:"Add Billing"})]})]})]},s.id))]}),e.jsxs("div",{className:"mt-8",children:[e.jsx("h2",{className:"text-sm font-semibold mb-2",children:"Billing Discounts"}),n.billing_discounts.length===0?e.jsx("p",{className:"text-sm text-gray-500",children:"No billing discounts added for this school year."}):e.jsx("ul",{className:"list-disc pl-5 space-y-1",children:n.billing_discounts.map(s=>{var a;return e.jsxs("li",{className:"text-sm text-gray-700",children:[(a=s.category)==null?void 0:a.name,": ₱",s.amount]},s.id)})}),e.jsx(i,{variant:"outline",className:"mt-4",onClick:()=>le(),children:"Add Discount"})]}),e.jsxs("div",{children:[e.jsx(y,{open:z,onOpenChange:A,children:e.jsxs(N,{className:"sm:max-w-[425px]",children:[e.jsxs(b,{children:[e.jsx(f,{children:"Year Level"}),e.jsx(v,{children:"Create a new year level."})]}),e.jsxs("form",{onSubmit:K,className:"space-y-4",children:[e.jsx("div",{className:"space-y-2",children:e.jsx(d,{id:"yearLevelName",name:"yearLevelName",value:B.yearLevelName,onChange:Q,placeholder:"e.g. Grade 1",required:!0})}),e.jsx(C,{children:e.jsx(i,{type:"submit",disabled:k,children:k?e.jsxs(e.Fragment,{children:[e.jsx(R,{className:"mr-2 h-4 w-4 animate-spin"})," Creating..."]}):"Create"})})]})]})}),e.jsx(y,{open:U,onOpenChange:h,children:e.jsxs(N,{className:"sm:max-w-[425px]",children:[e.jsxs(b,{children:[e.jsx(f,{children:"Class Arm"}),e.jsx(v,{children:"Add a new class arm."})]}),e.jsxs("form",{onSubmit:X,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{id:"classArmName",name:"classArmName",value:E.classArmName,onChange:Y,placeholder:"e.g. Section A",className:S.classArmName?"border-red-500":""}),S.classArmName&&e.jsx("p",{className:"text-sm text-red-500",children:S.classArmName})]}),e.jsxs(C,{children:[e.jsx(i,{type:"button",variant:"outline",onClick:()=>h(!1),children:"Cancel"}),e.jsx(i,{type:"submit",disabled:I,children:I?e.jsxs(e.Fragment,{children:[e.jsx(R,{className:"mr-2 h-4 w-4 animate-spin"})," Adding..."]}):"Add"})]})]})]})}),e.jsx(y,{open:Z,onOpenChange:x,children:e.jsxs(N,{className:"sm:max-w-[425px]",children:[e.jsxs(b,{children:[e.jsx(f,{children:"Billing"}),e.jsx(v,{children:"Create a new billing."})]}),e.jsxs("form",{onSubmit:se,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{id:"billingCategory",className:"block text-sm font-medium text-gray-700",children:"Category"}),e.jsx(d,{id:"billingCategory",name:"category",value:p.category,onChange:w,placeholder:"e.g. Tuition Fee",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{id:"billingDescription",className:"block text-sm font-medium text-gray-700",children:"Description"}),e.jsx(d,{id:"billingDescription",name:"description",value:p.description,onChange:w,placeholder:"e.g. Monthly Fee",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{id:"billingAmount",className:"block text-sm font-medium text-gray-700",children:"Amount"}),e.jsx(d,{id:"billingAmount",name:"amount",value:p.amount,onChange:w,placeholder:"e.g. Monthly Fee",required:!0})]}),e.jsxs(C,{children:[e.jsx(i,{type:"button",variant:"outline",onClick:()=>x(!1),children:"Cancel"}),e.jsx(i,{type:"submit",children:"Create"})]})]})]})}),e.jsx(y,{open:ae,onOpenChange:g,children:e.jsxs(N,{className:"sm:max-w-[425px]",children:[e.jsxs(b,{children:[e.jsx(f,{children:"Discount"}),e.jsx(v,{children:"Create a new discount."})]}),e.jsxs("form",{onSubmit:te,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{id:"billingCategory",className:"block text-sm font-medium text-gray-700",children:"Category"}),e.jsxs(O,{onValueChange:s=>j(a=>({...a,billing_cat_id:Number(s)})),value:m.billing_cat_id>0?m.billing_cat_id.toString():void 0,children:[e.jsx(G,{className:"w-full",children:e.jsx(H,{placeholder:"Select category to apply"})}),e.jsx(P,{children:$.map(s=>e.jsx(L,{value:s.id.toString(),children:s.name},s.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{id:"billingDescription",className:"block text-sm font-medium text-gray-700",children:"Description"}),e.jsx(d,{id:"billingDescription",name:"description",value:m.description,onChange:V,required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{id:"billingValue",className:"block text-sm font-medium text-gray-700",children:"Value"}),e.jsxs(O,{onValueChange:s=>j(a=>({...a,value:s})),value:m.value||void 0,children:[e.jsx(G,{className:"w-full",children:e.jsx(H,{placeholder:"Select discount type"})}),e.jsx(P,{children:e.jsxs(ue,{children:[e.jsx(L,{value:"fixed",children:"Fixed"}),e.jsx(L,{value:"percentage",children:"Percentage"})]})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{id:"billingAmount",className:"block text-sm font-medium text-gray-700",children:"Amount"}),e.jsx(d,{id:"billingAmount",name:"amount",value:m.amount,onChange:V,required:!0})]}),e.jsxs(C,{children:[e.jsx(i,{type:"button",variant:"outline",onClick:()=>g(!1),children:"Cancel"}),e.jsx(i,{type:"submit",children:"Create"})]})]})]})})]})]})}export{Ee as default};
